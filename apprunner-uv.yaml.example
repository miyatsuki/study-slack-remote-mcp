# UV を使用する場合の apprunner.yaml の例
# 現在のpipベースの設定が動作確認できたら、この設定に切り替えることができます

version: 1.0
runtime: python311
build:
  commands:
    pre-build:
      # uvをpip経由でインストール
      - pip install uv
    build:
      # uv syncでプロジェクトの依存関係をインストール
      - uv sync --frozen
run:
  runtime-version: 3.11
  # uv runを使って仮想環境内でサーバーを実行
  command: uv run python server.py
  network:
    port: 8080
    env: PORT
  env:
    - name: AWS_REGION
      value: ap-northeast-1
    - name: DYNAMODB_TABLE_NAME
      value: slack-mcp-tokens-dev
    - name: MCP_ENV
      value: dev
  secrets:
    - name: SERVICE_BASE_URL
      value-from: /slack-mcp/dev/service-base-url
    - name: SLACK_CLIENT_ID
      value-from: /slack-mcp/dev/client-id
    - name: SLACK_CLIENT_SECRET
      value-from: /slack-mcp/dev/client-secret